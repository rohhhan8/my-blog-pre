import{f as j,u as k,r as d,j as e,h as v,L as g,B as N,i as _,g as b}from"./index-0685d0f1.js";const E=()=>{var u,p;const{username:t}=j(),{currentUser:a}=k(),[r,h]=d.useState(null),[w,f]=d.useState(!0),[m,i]=d.useState(""),[y,x]=d.useState(!1);return d.useEffect(()=>{(async()=>{try{f(!0);let o;if(a){if(console.log("Fetching profile for logged in user:",a.displayName),!t||t===a.displayName)try{o=await _(),o.auth_warning&&(console.log("Auth warning from server:",o.auth_warning),i("Authentication warning: "+o.auth_warning)),x(!0)}catch(s){if(console.error("Error fetching own profile:",s),s.response)if(console.log("Profile error response status:",s.response.status),console.log("Profile error response data:",s.response.data),s.response.status===404||s.response.status===403)console.log("Creating default profile due to 404 or 403 error"),o={username:a.displayName||a.email.split("@")[0],display_name:a.displayName||"",bio:s.response.status===403?"Unable to fetch your complete profile due to an authentication issue. Try logging out and back in.":"Your profile has not been set up yet. Click Edit Profile to add your details.",profession:"",gender:"",location:"",website:"",avatar_url:a.photoURL||"",blog_count:0,member_since:new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}),created_at:new Date().toISOString()},s.response.status===403&&i("Authentication issue detected. Some profile features may be limited. Try logging out and back in.");else throw s;else console.log("Creating default profile due to non-response error"),o={username:a.displayName||a.email.split("@")[0],display_name:a.displayName||"",bio:"Unable to fetch your profile due to a network issue. Please check your connection.",profession:"",gender:"",location:"",website:"",avatar_url:a.photoURL||"",blog_count:0,member_since:new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}),created_at:new Date().toISOString()},i("Network issue detected. Unable to fetch your complete profile.")}else try{console.log(`Attempting to fetch profile for username: ${t}`);const s=decodeURIComponent(t);o=await b(s),console.log("Successfully fetched profile:",o),x(!1)}catch(s){console.error(`Error fetching profile for ${t}:`,s);let n=null;try{const l=localStorage.getItem("lastViewedAuthor");if(l){const c=JSON.parse(l);console.log("Found author info in localStorage:",c),c.username.toLowerCase()===t.toLowerCase()&&(console.log("Using cached author info from localStorage"),n=c)}}catch(l){console.error("Error reading author info from localStorage:",l)}if(!n)try{console.log(`Attempting to find author info for ${t} from blogs`)}catch(l){console.error("Error finding author info from blogs:",l)}o={username:t,display_name:n?n.display_name:t,bio:"This author has not created a complete profile yet.",profession:"Writer",gender:"",location:"",website:"",avatar_url:"",blog_count:0,member_since:"Unknown",created_at:new Date().toISOString()},i(`${t}'s profile is not fully set up yet. Showing available information.`)}o&&h(o)}else if(!t)i("Please log in to view your profile");else try{console.log(`Attempting to fetch profile for username (not logged in): ${t}`);const s=decodeURIComponent(t);o=await b(s),console.log("Successfully fetched profile (not logged in):",o),h(o),x(!1),i("")}catch(s){console.error(`Error fetching public profile for ${t}:`,s);let n=null;try{const l=localStorage.getItem("lastViewedAuthor");if(l){const c=JSON.parse(l);console.log("Found author info in localStorage (not logged in):",c),c.username.toLowerCase()===t.toLowerCase()&&(console.log("Using cached author info from localStorage (not logged in)"),n=c)}}catch(l){console.error("Error reading author info from localStorage (not logged in):",l)}if(!n)try{console.log(`Attempting to find author info for ${t} from blogs (not logged in)`)}catch(l){console.error("Error finding author info from blogs (not logged in):",l)}o={username:t,display_name:n?n.display_name:t,bio:"This author has not created a complete profile yet.",profession:"Writer",gender:"",location:"",website:"",avatar_url:"",blog_count:0,member_since:"Unknown",created_at:new Date().toISOString()},h(o),i(`${t}'s profile is not fully set up yet. Showing available information.`)}}catch(o){console.error("Error in profile fetch process:",o),i("Failed to load profile. Please try again later.")}finally{f(!1)}})()},[t,a]),w?e.jsx(v,{}):m&&!r?e.jsx("div",{className:"min-h-screen bg-blog-bg dark:bg-black pt-32 flex justify-center",children:e.jsxs("div",{className:"bg-white dark:bg-black rounded-lg shadow-md border border-gray-200 dark:border-gray-700 p-6 max-w-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:"Error"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-6",children:m}),e.jsx(g,{to:"/",className:"bg-blog-accent text-white px-4 py-2 rounded hover:bg-opacity-90 transition-colors",children:"Return to Home"})]})}):r?e.jsx("div",{className:"min-h-screen bg-blog-bg dark:bg-black page-content",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white dark:bg-black rounded-lg shadow-md border border-gray-200 dark:border-gray-700 overflow-hidden",children:[m&&r&&e.jsx("div",{className:"p-4 mb-4 bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-800 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-200",children:m})})]})}),e.jsx("div",{className:"p-4 sm:p-6 md:p-8 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start gap-4 sm:gap-6",children:[e.jsx("div",{className:"w-24 h-24 sm:w-28 md:w-32 sm:h-28 md:h-32 rounded-full bg-gray-900 dark:bg-white flex items-center justify-center text-white dark:text-gray-900 text-4xl font-medium overflow-hidden shadow-md",children:r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:r.display_name||r.username,className:"w-full h-full object-cover"}):(((u=r.display_name)==null?void 0:u.charAt(0))||((p=r.username)==null?void 0:p.charAt(0))||"U").toUpperCase()}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-1 sm:mb-2",children:r.display_name||r.username}),r.profession&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-base sm:text-lg mb-2",children:r.profession}),e.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap justify-center sm:justify-start gap-3 sm:gap-4 mt-3 sm:mt-4",children:[e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsxs("span",{className:"truncate",children:["Member since ",r.member_since]})]}),e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1M19 20a2 2 0 002-2V8a2 2 0 00-2-2h-5a2 2 0 00-2 2v12a2 2 0 002 2h5z"})}),e.jsxs("span",{children:[r.blog_count," ",r.blog_count===1?"post":"posts"]})]}),r.gender&&e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{children:r.gender})]}),r.location&&e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"truncate",children:r.location})]})]}),(y||!t&&a)&&e.jsx("div",{className:"mt-4 sm:mt-6",children:e.jsx(g,{to:"/profile/edit",children:e.jsx(N,{variant:"secondary",className:"px-4 sm:px-6 py-1.5 sm:py-2 text-sm sm:text-base",children:"Edit Profile"})})})]})]})}),r.bio&&e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-2 sm:mb-4",children:"About"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-line text-sm sm:text-base",children:r.bio})]}),r.website&&e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-2 sm:mb-4",children:"Website"}),e.jsx("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",className:"text-blog-accent hover:underline text-sm sm:text-base break-all",children:r.website})]}),e.jsx("div",{className:"p-4 sm:p-6 md:p-8",children:e.jsxs(g,{to:"/",className:"inline-flex items-center text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white text-sm sm:text-base",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Home"]})})]})})}):e.jsx("div",{className:"min-h-screen bg-blog-bg dark:bg-black pt-32 flex justify-center",children:e.jsxs("div",{className:"bg-white dark:bg-black rounded-lg shadow-md border border-gray-200 dark:border-gray-700 p-6 max-w-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Profile Not Found"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-6",children:"The requested profile could not be found."}),e.jsx(g,{to:"/",className:"bg-blog-accent text-white px-4 py-2 rounded hover:bg-opacity-90 transition-colors",children:"Return to Home"})]})})};export{E as default};
